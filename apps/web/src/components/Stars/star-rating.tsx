import { cn } from '@blms/ui';

interface StarRatingProps extends React.HTMLProps<HTMLDivElement> {
  rating: number;
  totalStars?: number;
  fillColor?: string;
  strokeColor?: string;
  unfilledStrokeColor?: string;
}

export const StarRating = ({
  rating,
  totalStars = 5,
  fillColor = '#FF5C00',
  strokeColor = '#FF5C00',
  unfilledStrokeColor = '#FF5C0030',
  className,
}: StarRatingProps) => {
  const fullStars = Math.floor(rating);
  const partialStar = rating - fullStars;
  const stars = [];

  for (let i = 0; i < fullStars; i++) {
    stars.push(
      <svg
        key={`full-${i}`}
        xmlns="http://www.w3.org/2000/svg"
        width="41"
        height="40"
        viewBox="0 0 41 40"
        fill="none"
      >
        <path
          d="M21.6545 6.47408C22.0866 5.59857 22.3027 5.16082 22.5961 5.02095C22.8513 4.89927 23.1478 4.89927 23.403 5.02095C23.6964 5.16082 23.9124 5.59857 24.3446 6.47408L28.4446 14.7803C28.5722 15.0387 28.636 15.168 28.7292 15.2683C28.8118 15.3572 28.9108 15.4291 29.0207 15.4803C29.1449 15.538 29.2875 15.5589 29.5727 15.6006L38.7439 16.9411C39.7096 17.0822 40.1925 17.1528 40.416 17.3887C40.6104 17.5939 40.7018 17.8759 40.6648 18.1562C40.6223 18.4783 40.2727 18.8188 39.5735 19.4998L32.9397 25.9612C32.7329 26.1626 32.6295 26.2633 32.5628 26.3831C32.5037 26.4892 32.4658 26.6058 32.4512 26.7263C32.4347 26.8625 32.4591 27.0047 32.5079 27.2893L34.0732 36.4156C34.2383 37.3782 34.3208 37.8594 34.1657 38.1451C34.0307 38.3935 33.7908 38.5678 33.5128 38.6194C33.1932 38.6786 32.761 38.4513 31.8966 37.9968L23.6977 33.6851C23.4423 33.5507 23.3145 33.4835 23.18 33.4571C23.0608 33.4338 22.9383 33.4338 22.8191 33.4571C22.6846 33.4835 22.5568 33.5507 22.3014 33.6851L14.1025 37.9968C13.2381 38.4513 12.8059 38.6786 12.4863 38.6194C12.2083 38.5678 11.9684 38.3935 11.8334 38.1451C11.6783 37.8594 11.7608 37.3782 11.9259 36.4156L13.4912 27.2893C13.54 27.0047 13.5644 26.8625 13.5479 26.7263C13.5332 26.6058 13.4953 26.4892 13.4363 26.3831C13.3696 26.2633 13.2662 26.1626 13.0594 25.9611L6.42556 19.4998C5.72638 18.8188 5.37679 18.4783 5.33425 18.1562C5.29724 17.8759 5.38867 17.5939 5.58311 17.3887C5.80658 17.1528 6.28946 17.0822 7.25522 16.9411L16.4263 15.6006C16.7116 15.5589 16.8542 15.538 16.9784 15.4803C17.0883 15.4291 17.1873 15.3572 17.2699 15.2683C17.3631 15.168 17.4269 15.0387 17.5545 14.7803L21.6545 6.47408Z"
          fill={fillColor}
          stroke={strokeColor}
          strokeWidth="2.5"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </svg>,
    );
  }

  if (partialStar > 0) {
    stars.push(
      <svg
        key="partial"
        xmlns="http://www.w3.org/2000/svg"
        width="41"
        height="40"
        viewBox="0 0 41 40"
        fill="none"
      >
        <defs>
          <linearGradient
            id="partialStarGradient"
            gradientTransform="rotate(10)"
          >
            <stop offset={`${partialStar * 100}%`} stopColor={fillColor} />
            <stop offset={`${partialStar * 100}%`} stopColor="transparent" />
          </linearGradient>
        </defs>
        <path
          d="M21.6545 6.47408C22.0866 5.59857 22.3027 5.16082 22.5961 5.02095C22.8513 4.89927 23.1478 4.89927 23.403 5.02095C23.6964 5.16082 23.9124 5.59857 24.3446 6.47408L28.4446 14.7803C28.5722 15.0387 28.636 15.168 28.7292 15.2683C28.8118 15.3572 28.9108 15.4291 29.0207 15.4803C29.1449 15.538 29.2875 15.5589 29.5727 15.6006L38.7439 16.9411C39.7096 17.0822 40.1925 17.1528 40.416 17.3887C40.6104 17.5939 40.7018 17.8759 40.6648 18.1562C40.6223 18.4783 40.2727 18.8188 39.5735 19.4998L32.9397 25.9612C32.7329 26.1626 32.6295 26.2633 32.5628 26.3831C32.5037 26.4892 32.4658 26.6058 32.4512 26.7263C32.4347 26.8625 32.4591 27.0047 32.5079 27.2893L34.0732 36.4156C34.2383 37.3782 34.3208 37.8594 34.1657 38.1451C34.0307 38.3935 33.7908 38.5678 33.5128 38.6194C33.1932 38.6786 32.761 38.4513 31.8966 37.9968L23.6977 33.6851C23.4423 33.5507 23.3145 33.4835 23.18 33.4571C23.0608 33.4338 22.9383 33.4338 22.8191 33.4571C22.6846 33.4835 22.5568 33.5507 22.3014 33.6851L14.1025 37.9968C13.2381 38.4513 12.8059 38.6786 12.4863 38.6194C12.2083 38.5678 11.9684 38.3935 11.8334 38.1451C11.6783 37.8594 11.7608 37.3782 11.9259 36.4156L13.4912 27.2893C13.54 27.0047 13.5644 26.8625 13.5479 26.7263C13.5332 26.6058 13.4953 26.4892 13.4363 26.3831C13.3696 26.2633 13.2662 26.1626 13.0594 25.9611L6.42556 19.4998C5.72638 18.8188 5.37679 18.4783 5.33425 18.1562C5.29724 17.8759 5.38867 17.5939 5.58311 17.3887C5.80658 17.1528 6.28946 17.0822 7.25522 16.9411L16.4263 15.6006C16.7116 15.5589 16.8542 15.538 16.9784 15.4803C17.0883 15.4291 17.1873 15.3572 17.2699 15.2683C17.3631 15.168 17.4269 15.0387 17.5545 14.7803L21.6545 6.47408Z"
          fill="url(#partialStarGradient)"
          stroke={unfilledStrokeColor}
          strokeWidth="2.5"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </svg>,
    );
  }

  for (let i = 0; i <= totalStars - stars.length; i++) {
    stars.push(
      <svg
        key={`empty-${i}`}
        xmlns="http://www.w3.org/2000/svg"
        width="41"
        height="40"
        viewBox="0 0 41 40"
        fill="none"
      >
        <path
          d="M21.6545 6.47408C22.0866 5.59857 22.3027 5.16082 22.5961 5.02095C22.8513 4.89927 23.1478 4.89927 23.403 5.02095C23.6964 5.16082 23.9124 5.59857 24.3446 6.47408L28.4446 14.7803C28.5722 15.0387 28.636 15.168 28.7292 15.2683C28.8118 15.3572 28.9108 15.4291 29.0207 15.4803C29.1449 15.538 29.2875 15.5589 29.5727 15.6006L38.7439 16.9411C39.7096 17.0822 40.1925 17.1528 40.416 17.3887C40.6104 17.5939 40.7018 17.8759 40.6648 18.1562C40.6223 18.4783 40.2727 18.8188 39.5735 19.4998L32.9397 25.9612C32.7329 26.1626 32.6295 26.2633 32.5628 26.3831C32.5037 26.4892 32.4658 26.6058 32.4512 26.7263C32.4347 26.8625 32.4591 27.0047 32.5079 27.2893L34.0732 36.4156C34.2383 37.3782 34.3208 37.8594 34.1657 38.1451C34.0307 38.3935 33.7908 38.5678 33.5128 38.6194C33.1932 38.6786 32.761 38.4513 31.8966 37.9968L23.6977 33.6851C23.4423 33.5507 23.3145 33.4835 23.18 33.4571C23.0608 33.4338 22.9383 33.4338 22.8191 33.4571C22.6846 33.4835 22.5568 33.5507 22.3014 33.6851L14.1025 37.9968C13.2381 38.4513 12.8059 38.6786 12.4863 38.6194C12.2083 38.5678 11.9684 38.3935 11.8334 38.1451C11.6783 37.8594 11.7608 37.3782 11.9259 36.4156L13.4912 27.2893C13.54 27.0047 13.5644 26.8625 13.5479 26.7263C13.5332 26.6058 13.4953 26.4892 13.4363 26.3831C13.3696 26.2633 13.2662 26.1626 13.0594 25.9611L6.42556 19.4998C5.72638 18.8188 5.37679 18.4783 5.33425 18.1562C5.29724 17.8759 5.38867 17.5939 5.58311 17.3887C5.80658 17.1528 6.28946 17.0822 7.25522 16.9411L16.4263 15.6006C16.7116 15.5589 16.8542 15.538 16.9784 15.4803C17.0883 15.4291 17.1873 15.3572 17.2699 15.2683C17.3631 15.168 17.4269 15.0387 17.5545 14.7803L21.6545 6.47408Z"
          fill="none"
          stroke={unfilledStrokeColor}
          strokeWidth="2.5"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </svg>,
    );
  }

  return <div className={cn('flex gap-5', className)}>{stars}</div>;
};
